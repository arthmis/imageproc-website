<!DOCTYPE html>
<html>

    <head>
        <title>Image Processing Demonstration</title>
        <meta content="text/html;charset=UTF-8" http-equiv="Content-Type"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.5">
        <link rel="stylesheet" type = "text/css" href="main.css"/>

    </head>

    <body>
        <nav class="navbar">
            <a href="index.html">
                <!-- Icon made by Freepik from www.flaticon.com -->
                <img src="./icons/house-black-silhouette-without-door.svg" alt="home page">
            </a>
            
            <button id="upload-image">Upload Image</button>
        </nav>
        <div id="main">
            <div id="options">
                <div id="input-image"> 
                    <input type="file" id="file-input" accept="image/png, image/jpeg" style="display: none;">
                    <!-- <button id="upload-image">Import</button> -->
                </div>

                <ul class="processing-category"><span>Pixel Operations</span>
                    <li id="invert-option" class="sidebar-elem sidebar-first-elem">Invert</li>
                    <li id="gamma-option" class="sidebar-elem">Gamma</li>
                </ul>

                <ul class="processing-category"><span>Blur</span>
                    <li id="blur-options" class="processing-options sidebar-elem sidebar-first-elem">Box Blur</li>
                </ul>
            </div>
            <div id="image-options">
                <div id="two-canvases-wrapper">
                    <div id="two-canvases">
                        <canvas id="input-canvas" class="one-active-canvas"></canvas>
                        <canvas id="output-canvas"></canvas>
                    </div>
                    <div id="processing-options" style="display: none;">
                        <div id="box-blur-slider-wrapper" style="display: none;">
                            <input id="box-blur-slider" type="range" name="box-blur" min="1" max="51" step="2">
                            <label for="box-blur">box diameter</label>
                        </div>
                        <div id="gamma-slider-wrapper" style="display: none;">
                            <input id="gamma-slider" type="range" name="gamma" min="0.1" max="20" step="0.1">
                            <label for="gamma">gamma</label>
                        </div>
                    </div>
                    <div id="algorithm-info">
                        <div id="invert-info" class="algorithm-info algorithm-explanation" style="display: none;">
                            <h2>How Invert works</h2>
                            <p>
                                Color inversion is when the luminance of the pixel gets mapped to the opposite.
                                In other words, white gets mapped to black and black is mapped to white. If we assume
                                an image with the color channels red, green, blue and 8 bits per channel, then
                                the formula to map the luminance value is given by:
                                <blockquote>
                                    <i>I<sub>invert</sub>(x, y) = Luminance<sub>max</sub> - I(x, y)</i>
                                </blockquote>                        
                                where <i>I</i> is the image, <i>Luminance<sub>max</sub></i> is 255 for an image with 8 bits
                                per color channel, and <i>x</i> and <i>y</i> are the coordinates of the pixel.
                                Using the above formula, if you have the RGB pixel <i>I(x, y)</i> = (50, 120, 200)
                                then <i>I<sub>invert</sub>(x, y)</i> = (205, 135, 55).
                            </p>
                        </div>
                        <div id="box-blur-info" class="algorithm-info" style="display: none;">
                            <h2>How Box Blur works</h2>
                            <p>A box blur is a convolution filter of the form: </p>
                        </div>
                        <div id="gamma-info" class="algorithm-info algorithm-explanation" style="display: none;">
                            <h2>How Gamma works</h2>
                            <p>
                                Gamma, otherwise known as gamma encoding and decoding, or gamma correction, refers to expanding or compressing an image's dynamic
                                range. When an imaging system captures an image the light intensity information
                                is captured linearly. In other words, if the light intensity is recorded by the camera
                                with a value of 100, then 200 would be the equivalent of twice the brightness of 100.
                                However, the human vision system perceives light nonlinearly. We are more sensitive to darker tones
                                than lighter tones. Gamma encoding takes advantage of out perception of light by compressing
                                the dynamic range of an image, where less bits are used to describe lighter tones and darker tones, 
                                the ones we are more sensitive to, are given more bandwidth. Using this system, 8 bits are sufficient
                                to create smooth gradients. 
                            </p>
                            <p>
                                An example of perceptual brightness vs linear brightness differences is shown by the diagram below:
                            </p>
                            <div class="diagram">
                                <img src="./images/perceptual_brightness.jpeg" alt="Perceptual brightness example">
                                <p>
                                    The left square has the 8 bit brightness of 200
                                    The middle square has the 8 bit brightness of 100

                                </p>
                                <!-- <p>The left square has the 8 bit brightness of 200</p> -->
                            </div>
                            <p>
                                Image processing functions assume the 
                                image is in linear space. Linear space means that
                                the difference in brightness between each possible value is equal.
                                
                            </p>
                            <p>
                                An example of gamma encoding/decoding being used is the sRGB color space
                                most images are encoded in. It's the standard used on the web for all images. 
                                Before the image can be displayed, the GPU decodes the image for viewing on screen.
                                Most monitors are calibrated to display sRGB color space images. 
                            </p>
                            <p>
                                <blockquote>
                                    <i>I(x, y)<sub>encoded</sub> = I(x, y)<sup>1/&#947</sup></i>
                                </blockquote>
                            </p>


                        </div>

                    </div>
                </div>
            </div>
        </div>

        <script type="module" src="./js/dist/index.js"></script>
    </body>
</html>
