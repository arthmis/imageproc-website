!function(e){var t={};function i(a){if(t[a])return t[a].exports;var s=t[a]={i:a,l:!1,exports:{}};return e[a].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=t,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(a,s,function(t){return e[t]}.bind(null,s));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=1)}([,function(e,t,i){"use strict";i.r(t);class a{constructor(e){this.processed_image_canvas=e,this.processed_image_ctx=e.getContext("2d")}display_image(e){const[t,i]=this.scale_img_dimensions_to_canvas(e,this.processed_image_canvas);this.processed_image_canvas.width=this.processed_image_canvas.offsetWidth,this.processed_image_canvas.height=this.processed_image_canvas.offsetHeight;const a=(this.processed_image_canvas.width-t)/2,s=(this.processed_image_canvas.height-i)/2;this.processed_image_ctx.drawImage(e,a,s,t,i)}scale_img_dimensions_to_canvas(e,t){let i=0,a=e.height,s=e.width;const n=t.offsetWidth/e.width,o=t.offsetHeight/e.height;return i=n<o?n:o,(t.offsetWidth<e.width||t.offsetHeight<e.height)&&(s=Math.round(e.width*i),a=Math.round(e.height*i)),[s,a]}put_image(e){this.resize_canvases();let t=(this.processed_image_canvas.width-e.width)/2,i=(this.processed_image_canvas.height-e.height)/2;this.processed_image_ctx.putImageData(e,t,i,0,0,e.width,e.height)}draw_image(e){this.processed_image_canvas.width=this.processed_image_canvas.offsetWidth,this.processed_image_canvas.height=this.processed_image_canvas.offsetHeight;const[t,i]=this.scale_img_dimensions_to_canvas(e,this.processed_image_canvas),a=(this.processed_image_canvas.width-t)/2,s=(this.processed_image_canvas.height-i)/2;this.processed_image_ctx.drawImage(e,a,s,t,i)}resize_canvases(){this.processed_image_canvas.width=this.processed_image_canvas.offsetWidth,this.processed_image_canvas.height=this.processed_image_canvas.offsetHeight}display_only_processed_image(){this.processed_image_canvas.classList.remove("active-canvases"),this.processed_image_canvas.classList.add("one-active-canvas")}display_original_image_canvas(){this.processed_image_canvas.classList.add("active-canvases"),this.processed_image_canvas.classList.remove("one-active-canvas")}}class s{constructor(e,t){this.output_image=document.createElement("canvas"),this.original_image=document.createElement("canvas"),this.preview_image=document.createElement("canvas"),this.preview_image_ctx=this.preview_image.getContext("2d"),this.output_image_ctx=this.output_image.getContext("2d"),this.original_image_ctx=this.original_image.getContext("2d"),this.output_image.width=e.width,this.output_image.height=e.height,this.original_image.width=e.width,this.original_image.height=e.height,this.output_image_ctx.drawImage(e,0,0),this.original_image_ctx.drawImage(e,0,0),this.preview_image.offsetHeight;let[i,a]=function(e,t){let i=0,a=e.height,s=e.width;const n=t/e.width,o=t/e.height;i=n<o?n:o;(t<e.width||t<e.height)&&(s=Math.round(e.width*i),a=Math.round(e.height*i));return[s,a]}(e,1500);this.preview_image.width=i,this.preview_image.height=a,this.output_image.width=i,this.output_image.height=a,this.preview_image_ctx.drawImage(e,0,0,i,a),this.output_image_ctx.drawImage(e,0,0,i,a)}original_img(){return this.original_image_ctx.getImageData(0,0,this.original_image.width,this.original_image.height)}original_img_canvas(){return this.original_image}output_img_canvas(){return this.output_image}output_img(){return this.output_image_ctx.getImageData(0,0,this.output_image.width,this.output_image.height)}preview_img_canvas(){return this.preview_image}preview_img(){return this.preview_image_ctx.getImageData(0,0,this.preview_image.width,this.preview_image.height)}set_output_image(e){this.output_image_ctx.putImageData(e,0,0)}set_output_image_to_original(){this.set_output_image(this.original_img())}}const n=(e,t)=>{let i;return function(){const a=this,s=arguments;clearTimeout(i),i=setTimeout(()=>e.apply(a,s),t)}};!function(){let e=new Worker("./js/dist/bundle_worker.js");e.onmessage=e=>{if("wasm INITIALIZED"===e.data.message)console.log(""+e.data.message);else if("INVERTED"===e.data.message){let a=new ImageData(new Uint8ClampedArray(e.data.image),e.data.width);i.set_output_image(a),t.draw_image(i.output_img_canvas())}else if("BOX BLUR"===e.data.message){let a=new ImageData(new Uint8ClampedArray(e.data.image),e.data.width);i.set_output_image(a),t.draw_image(i.output_img_canvas())}else if("GAMMA"===e.data.message){let a=new ImageData(new Uint8ClampedArray(e.data.image),e.data.width);i.set_output_image(a),t.draw_image(i.output_img_canvas())}else if("SOBEL"===e.data.message){let a=new ImageData(new Uint8ClampedArray(e.data.image),e.data.width);i.set_output_image(a),t.draw_image(i.output_img_canvas())}};const t=new a(document.getElementById("input-canvas"));let i=null,o=new Image,d=document.getElementById("file-input");d.addEventListener("change",()=>{let a=d.files[0];var n;n=a,o.addEventListener("load",(function(){t.display_image(o),i=new s(o,t.processed_image_canvas),e.postMessage({message:"USER IMAGE",image:i.preview_img().data.buffer,width:i.preview_img().width},[i.original_img().data.buffer])})),o.src=window.URL.createObjectURL(n),d.value=null,l.style.display="none",null!==h&&(h.classList.remove("select-option"),h=null),null!==_&&(_.style.display="none"),null!==y&&(y.style.display="none"),t.display_only_processed_image()});let l=document.getElementById("large-upload-button");l.addEventListener("click",()=>{window.matchMedia("(max-width: 768px)")&&N.classList.contains("mobile-visible")&&(N.classList.remove("mobile-visible"),N.classList.add("mobile-hidden")),d.click()}),document.getElementById("upload-image").addEventListener("click",()=>{d.click()}),window.addEventListener("resize",()=>{if(null!==i){const[e,a]=function(e,t){let i=0,a=e.height,s=e.width;const n=t.offsetWidth/e.width,o=t.offsetHeight/e.height;i=n<o?n:o;(t.offsetWidth<e.width||t.offsetHeight<e.height)&&(s=Math.round(e.width*i),a=Math.round(e.height*i));return[s,a]}(i.original_img(),t.processed_image_canvas);t.resize_canvases(),t.resized_width=e,t.resized_height=a,t.draw_image(i.output_img_canvas())}});let g=document.getElementById("invert-option"),m=document.getElementById("box-blur-option"),r=document.getElementById("gamma-option"),c=document.getElementById("sobel-option"),h=null,u=document.getElementById("processing-options"),_=null,p=document.getElementById("invert-info"),v=document.getElementById("box-blur-info"),w=document.getElementById("gamma-info"),f=document.getElementById("sobel-info"),y=null;function b(e,t,i){null===y?(y=i,y.style.display=""):(y.style.display="none",y=i,y.style.display=""),null===_?(u.style.display="",_=t,_.style.display=""):(_.style.display="none",_=t,_.style.display="",u.style.display=""),null===h?(h=e,h.classList.add("select-option")):(h.classList.remove("select-option"),h=e,h.classList.add("select-option"))}function E(e){e.classList.remove("select-option"),_.style.display="none",y.style.display="none",h=null,_=null,y=null,u.style.display="none",S(),i.set_output_image_to_original(),t.draw_image(i.original_img_canvas())}document.getElementById("options").addEventListener("click",n(t=>{if(null!==h&&h.classList.remove("select-option"),t.target.matches("#invert-option")){if(null===i)return void alert("Upload an image to use these algorithms");h===g?E(g):(b(g,I,p),S(),e.postMessage({message:"INVERT",width:i.preview_img().width}))}if(t.target.matches("#box-blur-option")){if(null===i)return void alert("Upload an image to use these algorithms");if(h===m)E(m);else{b(m,M,v),S(),A.value=1,O.value=A.value;let t=A.valueAsNumber;e.postMessage({message:"BOX BLUR",width:i.preview_img().width,kernel_size:t})}}if(t.target.matches("#gamma-option")){if(null===i)return void alert("Upload an image to use these algorithms");h===r?E(r):(b(r,L,w),S(),B.value=1,x.value=1,e.postMessage({message:"GAMMA",width:i.preview_img().width,gamma:B.valueAsNumber}))}if(t.target.matches("#sobel-option")){if(null===i)return void alert("Upload an image to use these algorithms");h===c?E(c):(b(c,U,f),S(),k.value=123,D.value=123,e.postMessage({message:"SOBEL",width:i.preview_img().width,threshold:k.valueAsNumber}))}}),33);let I=document.getElementById("invert-button");I.addEventListener("click",n(()=>{e.postMessage({message:"INVERT BUTTON",image:i.output_img().data.buffer,width:i.output_img().width},[i.output_img().data.buffer])}),33);let L=document.getElementById("gamma-slider-wrapper"),B=document.getElementById("gamma-slider"),x=document.getElementById("gamma-value");B.addEventListener("input",n(t=>{let a=t.target.valueAsNumber;x.value=a,e.postMessage({message:"GAMMA",width:i.preview_img().width,gamma:a})},100));let M=document.getElementById("box-blur-slider-wrapper"),A=document.getElementById("box-blur-slider"),O=document.getElementById("box-blur-value");A.addEventListener("input",n(t=>{let a=t.target.valueAsNumber;O.value=a,e.postMessage({message:"BOX BLUR",width:i.preview_img().width,kernel_size:a})},100));const U=document.getElementById("sobel-slider-wrapper"),k=document.getElementById("sobel-slider");let D=document.getElementById("sobel-threshold");k.addEventListener("input",n((function(t){let a=t.target.valueAsNumber;D.value=a,e.postMessage({message:"SOBEL",width:i.preview_img().width,threshold:a})}),100));let N=document.getElementById("sidebar"),j=document.getElementById("open-algorithms"),T=document.getElementById("open-algorithms-arrow");function R(e){e.target.matches("#sidebar")||e.target.matches("#open-algorithms")||e.target.matches("#sidebar *")||S()}function S(){window.matchMedia("(max-width: 768px)").matches&&(N.classList.contains("slideopen")?(N.classList.remove("slideopen","mobile-visible"),N.classList.add("slideclose","mobile-hidden"),T.classList.remove("fa-angle-down"),T.classList.add("fa-angle-right"),window.removeEventListener("click",R)):(N.classList.contains("slideclose")||N.classList.contains("mobile-hidden"))&&(N.classList.remove("slideclose","mobile-hidden"),N.classList.add("slideopen","mobile-visible"),T.classList.remove("fa-angle-right"),T.classList.add("fa-angle-down"),window.addEventListener("click",R)))}j.addEventListener("click",()=>{S()})}()}]);